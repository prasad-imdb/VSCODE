PROCEDURE "PRASADKUMAR_BODDU"."PRASADKUMAR_BODDU::STORES_REVENUE"
(IN PROD_NAME  nvarchar(55)) 
	LANGUAGE SQLSCRIPT
	SQL SECURITY INVOKER 
	READS SQL DATA AS
BEGIN
/*****************************/
SELECT
    "STORE_NAME",
    "PRODUCT_NAME",
    SUM("QUANTITY" * "PRICE") AS revenue
FROM
    "SALES" 
        INNER JOIN
    "PRODUCTS" ON "PRODUCTS"."ID" = "SALES"."PRODUCT_ID"
        INNER JOIN
    "STORES" ON "STORES"."ID" = "SALES"."STORE_ID"
where "PRODUCT_NAME" = :PROD_NAME
GROUP BY "STORE_NAME" , "PRODUCT_NAME";

END;



CALL "PRASADKUMAR_BODDU"."PRASADKUMAR_BODDU::STORES_REVENUE"('iPad');