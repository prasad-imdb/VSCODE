/*
    The following queries use the Columns view of the Account_Usage schema to generate table column
    information
*/

Select
    Column_Name,                        -- Column name
    Table_Name,                         -- Table name
    Table_Schema,                       -- Table name
    Table_Catalog as Table_Database,    -- Database name
    Ordinal_Position,                   -- Ordinal position of the column
    Column_Default,                     -- Default value of the column
    Is_Nullable,                        -- Does the column allows nulls
    Data_Type,                          -- Data type
    Character_Maximum_Length,           -- Maximum length of characters for string columns
    Numeric_Precision,                  -- Numeric precision of numeric columns
    Numeric_Precision_Radix,            -- Radix of precision of numeric columns. This is generally either 2 or 10.
    Numeric_Scale,                      -- Scale of numeric columns. Number of digits to the right of the decimal place.
    Is_Identity,                        -- Is this an identity column?
    Identity_Generation,                -- Whether an identity column’s value is always generated or only generated by default. Snowflake only supports by default.
    Identity_Cycle,                     -- Whether the value of an identity column allows cycling. Snowflake only supports no cycle
    Comment,                            -- Column comments
    Deleted as Deleted_Timestamp        -- Deleted timestamp
From Snowflake.Account_Usage.Columns;


// This query uses the Columns view in the Account_Usage namespace to find deleted columns
Select 
    Column_Name,                        -- Column name
    Table_Name,                         -- Table name
    Table_Schema,                       -- Table name
    Table_Catalog as Table_Database,    -- Database name
    Ordinal_Position,                   -- Ordinal position of the column
    Column_Default,                     -- Default value of the column
    Is_Nullable,                        -- Does the column allows nulls
    Data_Type,                          -- Data type
    Character_Maximum_Length,           -- Maximum length of characters for string columns
    Numeric_Precision,                  -- Numeric precision of numeric columns
    Numeric_Precision_Radix,            -- Radix of precision of numeric columns. This is generally either 2 or 10.
    Numeric_Scale,                      -- Scale of numeric columns. Number of digits to the right of the decimal place.
    Is_Identity,                        -- Is this an identity column?
    Identity_Generation,                -- Whether an identity column’s value is always generated or only generated by default. Snowflake only supports by default.
    Identity_Cycle,                     -- Whether the value of an identity column allows cycling. Snowflake only supports no cycle
    Comment,                            -- Column comments
    Date(Deleted) as Deleted_Timestamp  -- DeletFrom Snowflake.Account_Usage.Columns
From Snowflake.Account_Usage.Columns
Where Deleted IS NOT NULL
Order By Table_Database, Table_Schema, Table_Name, Column_Name;